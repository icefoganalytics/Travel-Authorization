import { omitBy } from "lodash"

/**
 * Parses passenger information from the passengers section.
 *
 * @param {Array<string>} lines - The lines from the passengers section.
 * @returns {Array<Object>} An array of passenger objects.
 *
 * Handles both Unix and Windows line endings.
 *
 * NOTE: This function is currently not in use.
 * It was generated by a best effort conversion from legacy code to a more readable format.
 */
export function parseTravelportalPassengers(lines) {
  const passengers = []
  const passengerRegex = /^(\d+)\.\s*(.+?)\s*-\s*(.+)$/

  lines.split(/\r?\n/).forEach((line) => {
    const match = line.match(passengerRegex)
    if (match) {
      const [, passengerNumber, passengerName, passengerType] = match
      passengers.push({
        passengerNumber: passengerNumber || "",
        passengerName: passengerName || "",
        passengerType: passengerType || "",
      })
    }
  })

  const cleanedPassengers = passengers.map((passenger) =>
    omitBy(passenger, (value) => value === "")
  )
  return cleanedPassengers
}

export default parseTravelportalPassengers
